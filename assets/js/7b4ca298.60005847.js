"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[728],{8924:(e,i,r)=>{r.r(i),r.d(i,{assets:()=>o,contentTitle:()=>n,default:()=>l,frontMatter:()=>a,metadata:()=>d,toc:()=>c});var t=r(7624),s=r(2172);const a={sidebar_position:10},n="Overview",d={id:"infrastructure/docker/overview",title:"Overview",description:"Docker images are built and pushed to ECR during the CD pipeline, refer to the ci-cd.md for more details.",source:"@site/../docs/infrastructure/docker/overview.md",sourceDirName:"infrastructure/docker",slug:"/infrastructure/docker/overview",permalink:"/infrastructure/docker/overview",draft:!1,unlisted:!1,editUrl:"https://github.com/dvsa/vol-app/tree/main/docs/../docs/infrastructure/docker/overview.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/app/overview"},next:{title:"Overview",permalink:"/infrastructure/terraform/overview"}},o={},c=[];function h(e){const i={a:"a",admonition:"admonition",code:"code",h1:"h1",img:"img",mermaid:"mermaid",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(i.p,{children:["Docker images are built and pushed to ECR during the CD pipeline, refer to the ",(0,t.jsx)(i.a,{href:"/ci-cd",children:"ci-cd.md"})," for more details."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Docker Images",src:r(2432).c+"",width:"2132",height:"1095"})}),"\n",(0,t.jsx)(i.h1,{id:"layers",children:"Layers"}),"\n",(0,t.jsx)(i.p,{children:"The VOL application images are built up of the following high-level layers:"}),"\n",(0,t.jsx)(i.mermaid,{value:'---\nconfig:\n    securityLevel: "loose"\n    theme: neutral\n---\nblock-beta\n    block:image\n        columns 1\n        label["VOL Application Image"]\n        alpine["<a href=\'https://hub.docker.com/_/alpine\'>Alpine Linux</a>"]\n        php["<a href=\'https://hub.docker.com/_/php\'>PHP</a>"]\n        base["<a href=\'https://github.com/dvsa/dvsa-docker-images\'>DVSA Base Image</a>"]\n        app["<a href=\'https://github.com/dvsa/vol-app\'>VOL Application</a>"]\n\n        style label fill:transparent,stroke:0,stroke-width:0\n    end'}),"\n",(0,t.jsx)(i.h1,{id:"repositories",children:"Repositories"}),"\n",(0,t.jsx)(i.p,{children:"The following repositories are used to store the Docker images for the application components:"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"ECR Repository"}),(0,t.jsx)(i.th,{children:"Dockerfile Path"}),(0,t.jsx)(i.th,{children:"Application path"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://054614622558.dkr.ecr.eu-west-1.amazonaws.com/vol-app/api",children:(0,t.jsx)(i.code,{children:"vol-app/api"})})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://github.com/dvsa/vol-app/tree/main/infra/docker/api",children:(0,t.jsx)(i.code,{children:"infra/docker/api"})})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://github.com/dvsa/vol-app/tree/main/app/api",children:(0,t.jsx)(i.code,{children:"app/api"})})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://054614622558.dkr.ecr.eu-west-1.amazonaws.com/vol-app/selfserve",children:(0,t.jsx)(i.code,{children:"vol-app/selfserve"})})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://github.com/dvsa/vol-app/tree/main/infra/docker/selfserve",children:(0,t.jsx)(i.code,{children:"infra/docker/selfserve"})})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://github.com/dvsa/vol-app/tree/main/app/selfserve",children:(0,t.jsx)(i.code,{children:"app/selfserve"})})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://054614622558.dkr.ecr.eu-west-1.amazonaws.com/vol-app/internal",children:(0,t.jsx)(i.code,{children:"vol-app/internal"})})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://github.com/dvsa/vol-app/tree/main/infra/docker/internal",children:(0,t.jsx)(i.code,{children:"infra/docker/internal"})})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.a,{href:"https://github.com/dvsa/vol-app/tree/main/app/internal",children:(0,t.jsx)(i.code,{children:"app/internal"})})})]})]})]}),"\n",(0,t.jsx)(i.h1,{id:"image-tagging",children:"Image tagging"}),"\n",(0,t.jsx)(i.p,{children:"The Docker images are tagged during the CD pipeline with the following tags:"}),"\n",(0,t.jsx)(i.mermaid,{value:'gitGraph\n    commit id: "[git-sha1]"\n    commit tag: "v1.0.0" id: "1.0.0, 1.0, 1, [git-sha2]"\n    commit id: "[git-sha3]"\n    commit id: "[git-sha4]"\n    commit tag: "v1.1.0" id: "1.1.0, 1.1, 1, [git-sha5]"\n    commit tag: "v1.1.1" id: "1.1.1, 1.1, 1, [git-sha6]"\n    commit id: "[git-sha7]"\n    commit id: "[git-sha8]"\n    commit tag: "v1.2.0" id: "1.2.0, 1.2, 1, [git-sha9]"\n    commit id: "[git-sha10], latest"'}),"\n",(0,t.jsxs)(i.admonition,{type:"info",children:[(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Mutable tags"}),": ",(0,t.jsx)(i.code,{children:"latest"}),", ",(0,t.jsx)(i.code,{children:"[major].[minor]"}),", & ",(0,t.jsx)(i.code,{children:"[major]"}),"."]}),(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Immutable tags"}),": ",(0,t.jsx)(i.code,{children:"[major].[minor].[patch]"}),", & ",(0,t.jsx)(i.code,{children:"[git-sha]"}),"."]})]})]})}function l(e={}){const{wrapper:i}={...(0,s.M)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},2432:(e,i,r)=>{r.d(i,{c:()=>t});const t=r.p+"assets/images/docker-images-3b77d27fb91c89b3fde4d9f14bbece26.png"}}]);